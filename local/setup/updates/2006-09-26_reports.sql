UPDATE `reports` SET `id` = 607655, `dbase` = '', `user` = '', `label` = 'Census', `query` = '---[census]---\r\nselect\r\n concat(p.last_name,'', '',p.first_name) Patient,\r\n e.encounter_reason Reason,\r\n if (o.walkin,''Y'',''N'') `Walk-in?`,\r\n date_format(o.start,''%a %m/%d/%Y'') `Date`,\r\n concat_ws('' to '',date_format(o.start,''%H:%i''),date_format(o.end,''%H:%i'')) `Time`,\r\n concat_ws('', '',pro.last_name,pro.first_name) Provider,\r\n b.name Facility\r\nfrom\r\n occurences o\r\n inner join person p on o.external_id = p.person_id\r\n inner join encounter e on e.occurence_id = o.id\r\n left join person pro on e.treating_person_id = pro.person_id\r\n left join buildings b on e.building_id = b.id\r\nwhere\r\n if (''[after]'',o.start > ''[after:date]'',1) and\r\n if (''[before]'',o.end < ''[before:date]'',1) and\r\n if (''[facility]'',e.building_id = ''[facility:facility_practice_level]'',1) and\r\n if (''[provider]'',o.user_id = ''[provider:provider_practice_level]'',1)\r\norder by\r\n `Date` DESC, `Time` DESC\r\n/***\r\ndsFilters-Reason|enumLookup&ds|encounter_reason\r\n***/\r\n---[total_encounters,hideFilter,noPager]---\r\nselect\r\n count(e.encounter_id) `Total Encounters`\r\nfrom\r\n encounter e \r\n left join occurences o on e.occurence_id = o.id\r\n left join person p on o.external_id = p.person_id\r\nwhere\r\n if (''[after]'',e.date_of_treatment >= ''[after:date]'',1) and\r\n if (''[before]'',e.date_of_treatment <= ''[before:date]'',1) and\r\n if (''[facility]'',e.building_id = ''[facility]'',1) and\r\n if (''[provider]'',o.user_id = ''[provider]'',1)\r\n---[total_encounters_by_reason,hideFilter,noPager]---\r\nselect\r\n e.encounter_reason `Reason`,\r\n count(e.encounter_id) `Total`\r\nfrom\r\n occurences o\r\n inner join person p on o.external_id = p.person_id\r\n inner join encounter e on e.occurence_id = o.id\r\nwhere\r\n if (''[after]'',o.start > ''[after:date]'',1) and\r\n if (''[before]'',o.end < ''[before:date]'',1) and\r\n if (''[facility]'',e.building_id = ''[facility]'',1) and\r\n if (''[provider]'',o.user_id = ''[provider]'',1)\r\ngroup by\r\n o.reason_code\r\n/***\r\ndsFilters-Reason|enumLookup&ds|encounter_reason\r\n***/\r\n---[total_encounters_by_walkin,hideFilter,noPager]---\r\nselect\r\n if (o.walkin,''Y'',''N'') `Walk-in?`,\r\n count(e.encounter_id) `Total`\r\nfrom\r\n occurences o\r\n inner join person p on o.external_id = p.person_id\r\n inner join encounter e on e.occurence_id = o.id\r\nwhere\r\n if (''[after]'',o.start > ''[after:date]'',1) and\r\n if (''[before]'',o.end < ''[before:date]'',1) and\r\n if (''[facility]'',e.building_id = ''[facility]'',1) and\r\n if (''[provider]'',o.user_id = ''[provider]'',1)\r\ngroup by\r\n o.walkin\r\n---[total_encounters_by_facility,hideFilter,noPager]---\r\nselect\r\n b.name Facility,\r\n count(e.encounter_id) total\r\nfrom\r\n occurences o\r\n inner join person p on o.external_id = p.person_id\r\n inner join encounter e on e.occurence_id = o.id\r\n inner join buildings b on e.building_id = b.id\r\nwhere\r\n if (''[after]'',o.start > ''[after:date]'',1) and\r\n if (''[before]'',o.end < ''[before:date]'',1) and\r\n if (''[facility]'',e.building_id = ''[facility]'',1) and\r\n if (''[provider]'',o.user_id = ''[provider]'',1)\r\ngroup by\r\n b.id\r\n---[total_encounters_by_provider,hideFilter,noPager]---\r\nselect\r\n concat_ws('', '',pro.last_name,pro.first_name) Provider,\r\n count(e.encounter_id) total\r\nfrom\r\n occurences o\r\n inner join person p on o.external_id = p.person_id\r\n inner join encounter e on e.occurence_id = o.id\r\n inner join person pro on e.treating_person_id = pro.person_id\r\nwhere\r\n if (''[after]'',o.start > ''[after:date]'',1) and\r\n if (''[before]'',o.end < ''[before:date]'',1) and\r\n if (''[facility]'',e.building_id = ''[facility]'',1) and\r\n if (''[provider]'',o.user_id = ''[provider]'',1)\r\ngroup by\r\n pro.person_id\r\n', `description` = 'Census', `custom_id` = 'census' WHERE  `id` = 607655,
UPDATE `reports` SET `id` = 607661, `dbase` = '', `user` = '', `label` = 'Encounter Census', `query` = '---[total_encounters,noPager]---\r\nSELECT\r\n COUNT(e.encounter_id) `Total Encounters`\r\nFROM\r\n encounter e \r\n LEFT JOIN occurences AS o ON(e.occurence_id = o.id)\r\nWHERE\r\n IF (''[after]'',e.date_of_treatment >= ''[after:date]'',1) AND\r\n IF (''[before]'',e.date_of_treatment <= ''[before:date]'',1) AND\r\n IF (''[facility]'',e.building_id = ''[facility:facility_practice_level]'',1) AND\r\n IF (''[provider]'',e.treating_person_id = ''[provider:provider_practice_level]'',1) AND\r\n IF (''[reason]'',e.encounter_reason = ''[reason:enum:encounter_reason]'',1)\r\n---[total_encounters_by_reason,hideFilter,noPager]---\r\nSELECT\r\n e.encounter_reason `Reason`,\r\n count(e.encounter_id) `Total`\r\nFROM\r\n encounter AS e\r\n LEFT JOIN occurences AS o ON(e.occurence_id = o.id)\r\nWHERE\r\n IF (''[after]'',e.date_of_treatment >= ''[after:date]'',1) AND\r\n IF (''[before]'',e.date_of_treatment <= ''[before:date]'',1) AND\r\n IF (''[facility]'',e.building_id = ''[facility:query:SELECT id, name FROM buildings ORDER BY name]'',1) AND\r\n IF (''[provider]'',e.treating_person_id = ''[provider:query:SELECT prov.person_id, CONCAT(per.first_name, " ", last_name) FROM provider AS prov JOIN person AS per USING(person_id)]'',1) AND\r\n IF (''[reason]'',e.encounter_reason = ''[reason:enum:encounter_reason]'',1)\r\nGROUP BY\r\n e.encounter_reason\r\n/***\r\ndsFilters-Reason|enumLookup&ds|encounter_reason\r\n***/\r\n---[total_encounters_by_walkin,hideFilter,noPager]---\r\nSELECT\r\n IF (o.walkin,''Y'',''N'') `Walk-in?`,\r\n count(e.encounter_id) `Total`\r\nFROM\r\n encounter e\r\n INNER JOIN person AS p on e.patient_id = p.person_id\r\n LEFT JOIN occurences AS o on (e.occurence_id = o.id)\r\nWHERE\r\n IF (''[after]'',e.date_of_treatment >= ''[after:date]'',1) AND\r\n IF (''[before]'',e.date_of_treatment <= ''[before:date]'',1) AND\r\n IF (''[facility]'',e.building_id = ''[facility:query:SELECT id, name FROM buildings ORDER BY name]'',1) AND\r\n IF (''[provider]'',e.treating_person_id = ''[provider:query:SELECT prov.person_id, CONCAT(per.first_name, " ", last_name) FROM provider AS prov JOIN person AS per USING(person_id)]'',1) AND\r\n IF (''[reason]'',e.encounter_reason = ''[reason:enum:encounter_reason]'',1)\r\nGROUP BY\r\n `Walk-in?`\r\n---[total_encounters_by_facility,hideFilter,noPager]---\r\nSELECT\r\n b.name Facility,\r\n count(e.encounter_id) total\r\nFROM\r\n encounter AS e\r\n INNER JOIN buildings AS b ON(e.building_id = b.id)\r\n LEFT JOIN occurences AS o on (e.occurence_id = o.id)\r\nWHERE\r\n IF (''[after]'',e.date_of_treatment >= ''[after:date]'',1) AND\r\n IF (''[before]'',e.date_of_treatment <= ''[before:date]'',1) AND\r\n IF (''[facility]'',e.building_id = ''[facility:query:SELECT id, name FROM buildings ORDER BY name]'',1) AND\r\n IF (''[provider]'',e.treating_person_id = ''[provider:query:SELECT prov.person_id, CONCAT(per.first_name, " ", last_name) FROM provider AS prov JOIN person AS per USING(person_id)]'',1) AND\r\n IF (''[reason]'',e.encounter_reason = ''[reason:enum:encounter_reason]'',1)\r\nGROUP BY\r\n b.id\r\n---[total_encounters_by_provider,hideFilter,noPager]---\r\nSELECT\r\n concat_ws('', '',pro.last_name,pro.first_name) Provider,\r\n count(e.encounter_id) total\r\nFROM\r\n encounter e\r\n INNER JOIN person AS pro ON(e.treating_person_id = pro.person_id)\r\n LEFT JOIN occurences AS o on (e.occurence_id = o.id)\r\nWHERE\r\n IF (''[after]'',e.date_of_treatment >= ''[after:date]'',1) AND\r\n IF (''[before]'',e.date_of_treatment <= ''[before:date]'',1) AND\r\n IF (''[facility]'',e.building_id = ''[facility:query:SELECT id, name FROM buildings ORDER BY name]'',1) AND\r\n IF (''[provider]'',e.treating_person_id = ''[provider:query:SELECT prov.person_id, CONCAT(per.first_name, " ", last_name) FROM provider AS prov JOIN person AS per USING(person_id)]'',1) AND\r\n IF (''[reason]'',e.encounter_reason = ''[reason:enum:encounter_reason]'',1)\r\nGROUP BY\r\n pro.person_id\r\n', `description` = 'Encounter Census', `custom_id` = 'encountercensus' WHERE  `id` = 607661,
UPDATE `reports` SET `id` = 607670, `dbase` = '', `user` = '', `label` = 'No-Show Report', `query` = 'select \r\n date_format(o.start,''%a %m/%d/%Y'') `Date`,\r\n concat_ws('' to '',date_format(o.start,''%H:%i''),date_format(o.end,''%H:%i'')) `Time`, \r\n concat(\r\n  floor((unix_timestamp(o.end) - unix_timestamp(o.start)) / 60 / 60),\r\n  '' hours '',\r\n  floor((unix_timestamp(o.end) - unix_timestamp(o.start)) / 60 % 60),\r\n  '' minutes''\r\n )Duration, \r\n concat(b.name, ''->'', r.name) Location, \r\n concat(p.last_name,'', '',p.first_name) Patient, \r\n o.notes Title, \r\n o.reason_code Reason, \r\n concat(pro.last_name,'', '',pro.first_name) Provider\r\nfrom \r\n schedules s \r\n inner join events e on e.foreign_id = s.id\r\n inner join occurences o on e.id = o.event_id\r\n inner join rooms r on o.location_id = r.id\r\n inner join buildings b on b.id = r.building_id\r\n inner join person p on o.external_id = p.person_id\r\n inner join user u on o.user_id = u.user_id\r\n inner join person pro on u.person_id = pro.person_id\r\nwhere \r\n s.schedule_code = ''ns'' and\r\n if (''[after]'',o.start > ''[after:date]'',1) and\r\n if (''[before]'',o.end < ''[before:date]'',1) and\r\n if (''[facility]'',o.location_id = ''[facility:rooms_building_practice_level]'',1)\r\n\r\n/***\r\ndsFilters-Reason|enumLookup&ds|appointment_reasons\r\n***/\r\n', `description` = 'No-Show Report', `custom_id` = 'noshow' WHERE  `id` = 607670,
UPDATE `reports` SET `id` = 607672, `dbase` = '', `user` = '', `label` = 'Open Encounter Report', `query` = 'SELECT \r\n	DATE_FORMAT(date_of_treatment,''%m/%d/%Y'') AS date_of_treatment, \r\n	DATE_FORMAT(timestamp,''%m/%d/%Y'') AS last_change, \r\n	concat_ws('', '',p.last_name,p.first_name) AS patient,\r\n	e.encounter_id,\r\n	b.name AS "facility",\r\n	CONCAT_WS('', '', prov_person.last_name, prov_person.first_name) AS provider,\r\n	insurer.name AS insurance,\r\n	c.code_text AS ''Primary Diagnosis''\r\nFROM\r\n	encounter AS e\r\n	INNER JOIN person AS p on e.patient_id = p.person_id\r\n	JOIN buildings AS b ON(b.id = e.building_id)\r\n	JOIN provider AS prov ON(e.treating_person_id = prov.person_id)\r\n	JOIN person AS prov_person USING(person_id)\r\n	LEFT JOIN storage_int AS curprog ON(e.encounter_id = curprog.foreign_key AND curprog.value_key = ''current_payer'') \r\n	LEFT JOIN insurance_program AS insurer ON(curprog.value = insurer.insurance_program_id)\r\n	LEFT JOIN coding_data AS cd ON (e.encounter_id = cd.foreign_id)\r\n	LEFT JOIN codes AS c ON (cd.code_id = c.code_id)\r\nWHERE\r\n	e.status = ''open'' AND\r\n        (cd.primary_code = 1 OR cd.primary_code IS NULL) AND\r\n	IF (''[after]'', e.date_of_treatment >= ''[after:date]'', 1) AND\r\n	IF (''[before]'', e.date_of_treatment <= ''[before:date]'', 1) AND\r\n	IF (''[facility]'', e.building_id = ''[facility:facility_practice_level]'', 1) AND\r\n	IF (''[provider]'', e.treating_person_id = ''[provider:provider_practice_level]'', 1) AND\r\n	IF (''[insurance]'', insurer.insurance_program_id = ''[insurance:query:SELECT insurance_program_id, name FROM insurance_program WHERE LENGTH(name) > 0]'', 1)\r\nGROUP BY\r\n	e.encounter_id\r\n\r\n', `description` = 'Open Encounter Report', `custom_id` = 'openencounter' WHERE  `id` = 607672,
UPDATE `reports` SET `id` = 607684, `dbase` = '', `user` = '', `label` = 'Transaction Report', `query` = '/* Sql for a Transaction Report, tagged for using the standard reporting\r\nmechanism */\r\n---[Transaction_List]---\r\nselect \r\ndate_format(e.date_of_treatment,''%Y-%m-%d'') `payment_date`,\r\nconcat_ws('', '',p.last_name,p.first_name) patient,\r\npat.record_number,\r\npay.payment_type AS ''Payment Type'',\r\nformat(if(isnull(pay.amount),0,pay.amount),2) amount,\r\nconcat_ws('', '',pro.last_name,pro.first_name) provider,\r\nev.value encounter_note, \r\nconcat_ws('', '',per.last_name,per.first_name) user\r\nfrom encounter e\r\nleft join payment pay on pay.encounter_id = e.encounter_id\r\nleft join person p on e.patient_id = p.person_id\r\nleft join patient pat on p.person_id = pat.person_id\r\nleft join person pro on e.treating_person_id = pro.person_id\r\nleft join encounter_value ev on e.encounter_id = ev.encounter_id  AND\r\nev.value_type =1\r\nleft JOIN user u on e.created_by_user_id = u.user_id \r\nleft JOIN person per on per.person_id = u.person_id\r\nwhere \r\n\r\n(if (''[user]'',e.created_by_user_id =''[user:query:select user_id,\r\nconcat_ws('', '',last_name,first_name) name from user u inner join person\r\np using(person_id) order by last_name, first_name]'',1)\r\nor\r\nif (''[user2]'',e.created_by_user_id =''[user2:user_practice_level]'',0)\r\nor\r\nif (''[user3]'',e.created_by_user_id =''[user3:user_practice_level]'',0)\r\n)\r\nand \r\nif (''[date]'', e.date_of_treatment = ''[date:date]'', e.date_of_treatment = CURDATE()) and\r\nif(''[facility]'',e.building_id = ''[facility:facility_practice_level]'',1)\r\n\r\n\r\n\r\n/***\r\ndsFilters-Payment Type|enumLookup&ds|payment_type\r\n***/\r\n---[Total_payment_amount,hideFilter]---\r\nselect \r\nsum(pay.amount) total\r\nfrom payment pay\r\ninner join encounter e on pay.encounter_id = e.encounter_id\r\ninner join person p on e.patient_id = p.person_id\r\ninner join patient pat on p.person_id = pat.person_id\r\ninner join person pro on e.treating_person_id = pro.person_id\r\nwhere if (''[user]'',e.created_by_user_id =\r\n''[user]'',1)\r\n and pay.payment_date = ''[date:date]''\r\nand if(''[facility]'',e.building_id = ''[facility]'',1)\r\n\r\n\r\n---[Total_payment_amount_by_type,hideFilter]---\r\nselect \r\npay_ev.value AS ''Payment Type'',\r\nsum(pay.amount) total\r\nfrom encounter e\r\ninner join payment pay on pay.encounter_id = e.encounter_id\r\nleft join person p on e.patient_id = p.person_id\r\nleft join patient pat on p.person_id = pat.person_id\r\nleft join person pro on e.treating_person_id = pro.person_id\r\nJOIN enumeration_value AS pay_ev ON (pay.payment_type = pay_ev.key)\r\nJOIN enumeration_definition AS pay_ed ON(pay_ev.enumeration_id = pay_ed.enumeration_id AND pay_ed.name = ''payment_type'')\r\nwhere \r\nif (''[user]'',e.created_by_user_id = ''[user]'',1) and pay.payment_date = ''[date:date]'' and if(''[facility]'',e.building_id = ''[facility]'',1)\r\n\r\ngroup by payment_type\r\n\r\n---[Total_encounters_by_provider,hideFilter]---\r\nselect \r\nconcat_ws('', '',pro.last_name,pro.first_name) provider,\r\ncount(distinct e.encounter_id) total\r\nfrom encounter e\r\nleft join payment pay on pay.encounter_id = e.encounter_id\r\nleft join person p on e.patient_id = p.person_id\r\nleft join patient pat on p.person_id = pat.person_id\r\nleft join person pro on e.treating_person_id = pro.person_id\r\nwhere \r\n(if (''[user]'',e.created_by_user_id = ''[user]'',1) and e.date_of_treatment\r\n= ''[date:date]'' and if(''[facility]'',e.building_id = ''[facility]'',1)\r\nor\r\nif (''[user2]'',e.created_by_user_id = ''[user2]'',1) and\r\ne.date_of_treatment = ''[date:date]'' and if(''[facility]'',e.building_id =\r\n''[facility]'',0)\r\nor\r\nif (''[user3]'',e.created_by_user_id = ''[user3]'',1) and\r\ne.date_of_treatment = ''[date:date]'' and if(''[facility]'',e.building_id =\r\n''[facility]'',0))\r\ngroup by provider\r\n---[Total_encounters,hideFilter]---\r\nselect \r\ncount(distinct e.encounter_id) total\r\nfrom encounter e\r\nleft join payment pay on pay.encounter_id = e.encounter_id\r\nleft join person p on e.patient_id = p.person_id\r\nleft join patient pat on p.person_id = pat.person_id\r\nleft join person pro on e.treating_person_id = pro.person_id\r\nwhere \r\n(if (''[user]'',e.created_by_user_id = ''[user]'',1) and e.date_of_treatment\r\n= ''[date:date]'' and if(''[facility]'',e.building_id = ''[facility]'',1)\r\nor\r\nif (''[user2]'',e.created_by_user_id = ''[user2]'',2) and\r\ne.date_of_treatment = ''[date:date]'' and if(''[facility]'',e.building_id =\r\n''[facility]'',1)\r\nor\r\nif (''[user3]'',e.created_by_user_id = ''[user3]'',3) and\r\ne.date_of_treatment = ''[date:date]'' and if(''[facility]'',e.building_id =\r\n''[facility]'',1))\r\n', `description` = 'Transaction Report', `custom_id` = 'transactionreport' WHERE  `id` = 607684;